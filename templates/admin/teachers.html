{% extends "base.html" %}

{% block title %}Teachers - Admin{% endblock %}

{% block content %}
<div class="mb-8 flex items-center justify-between">
    <div>
        <h1 class="text-3xl font-bold text-gray-800">Teachers</h1>
        <p class="text-gray-600 mt-2">Manage all teachers in your school</p>
    </div>
    <a href="{{ url_for('admin.upload_teachers') }}" 
       class="bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-6 rounded-lg transition">
        <i class="fas fa-upload mr-2"></i>Upload Teachers
    </a>
</div>

<div class="bg-white rounded-lg shadow-md p-6">
    {% if teachers %}
    <div class="mb-6 flex flex-col md:flex-row md:items-center md:justify-between gap-4">
        <h2 class="text-xl font-bold text-gray-800">
            <i class="fas fa-chalkboard-teacher text-green-600 mr-2"></i>
            All Teachers ({{ teachers|length }})
        </h2>
        <input type="text" id="searchInput" placeholder="Search teachers..." 
               class="px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent w-full md:w-64">
    </div>

    <div id="teachersGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        {% for teacher in teachers %}
        <div class="teacher-card border-2 border-green-200 rounded-lg p-6 hover:shadow-lg hover:border-green-400 hover:scale-[1.02] transition-transform">
            <div class="flex items-start justify-between mb-4">
                <div class="flex items-center">
                    <div class="h-16 w-16 bg-gradient-to-br from-green-400 to-green-600 rounded-full flex items-center justify-center">
                        <span class="text-white font-bold text-xl">
                            {{ teacher.first_name[:1] if teacher.first_name else '?' }}{{ teacher.last_name[:1] if teacher.last_name else '' }}
                        </span>
                    </div>
                    <div class="ml-4">
                        <h3 class="text-lg font-bold text-gray-800">{{ teacher.full_name or 'Unnamed Teacher' }}</h3>
                        <p class="text-sm text-green-600 font-medium">{{ teacher.teacher_id or 'N/A' }}</p>
                    </div>
                </div>
            </div>
            
            <div class="space-y-2 mb-4">
                <div class="flex items-center text-sm text-gray-600">
                    <i class="fas fa-envelope text-gray-400 mr-2 w-4"></i>
                    <span class="truncate">{{ teacher.user.email if teacher.user else 'â€”' }}</span>
                </div>
                <div class="flex items-center text-sm text-gray-600">
                    <i class="fas fa-book text-gray-400 mr-2 w-4"></i>
                    <span>{{ teacher.subjects|length }} Subject(s)</span>
                </div>
                <div class="flex items-center text-sm text-gray-600">
                    <i class="fas fa-file-alt text-gray-400 mr-2 w-4"></i>
                    <span>{{ teacher.exams|length }} Exam(s)</span>
                </div>
            </div>

            {% if teacher.subjects %}
            <div class="border-t border-gray-200 pt-3">
                <p class="text-xs text-gray-500 font-medium mb-2">Subjects Teaching:</p>
                <div class="flex flex-wrap gap-2">
                    {% for subject in teacher.subjects[:3] %}
                    <span class="bg-green-100 text-green-800 text-xs px-2 py-1 rounded-full truncate" 
                          title="{{ subject.name }}">{{ subject.name }}</span>
                    {% endfor %}
                    {% if teacher.subjects|length > 3 %}
                    <span class="bg-gray-100 text-gray-600 text-xs px-2 py-1 rounded-full">
                        +{{ teacher.subjects|length - 3 }} more
                    </span>
                    {% endif %}
                </div>
            </div>
            {% endif %}

            <div class="mt-4">
                {% if teacher.user.is_active %}
                <span class="px-3 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800">
                    <i class="fas fa-check-circle mr-1"></i>Active
                </span>
                {% else %}
                <span class="px-3 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-red-100 text-red-800">
                    <i class="fas fa-times-circle mr-1"></i>Inactive
                </span>
                {% endif %}
            </div>
            
            <div class="mt-4 text-right">
                <a href="{{ url_for('admin.teacher_detail', teacher_id=teacher.id) }}"
                   class="inline-block bg-green-600 hover:bg-green-700 text-white text-sm font-semibold px-4 py-2 rounded-lg transition">
                    <i class="fas fa-eye mr-1"></i>View Details
                </a>
            </div>            
        </div>
        {% endfor %}
    </div>
    {% else %}
    <div class="text-center py-12">
        <i class="fas fa-chalkboard-teacher text-gray-300 text-6xl mb-4"></i>
        <p class="text-gray-500 text-lg">No teachers added yet</p>
        <p class="text-gray-400 text-sm mt-2">Upload teachers from Excel to get started</p>
        <a href="{{ url_for('admin.upload_teachers') }}" 
           class="mt-4 inline-block bg-green-600 hover:bg-green-700 text-white font-bold py-2 px-6 rounded-lg transition">
            <i class="fas fa-upload mr-2"></i>Upload Teachers
        </a>
    </div>
    {% endif %}
</div>
{% endblock %}

{% block scripts %}
<script>
document.getElementById('searchInput')?.addEventListener('input', function(e) {
    const term = e.target.value.toLowerCase();
    const cards = document.querySelectorAll('.teacher-card');
    cards.forEach(card => {
        const text = card.textContent.toLowerCase();
        card.style.display = text.includes(term) ? '' : 'none';
    });
});
</script>
{% endblock %}
